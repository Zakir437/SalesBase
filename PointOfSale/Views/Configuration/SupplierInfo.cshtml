@{
    ViewBag.Title = "SupplierInfo";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<h2>Supplier</h2>
<hr />
<button class="btn btn-default" id="btnSupplierCreateWin" style="margin-bottom:5px;"><i class="fa fa-plus-circle" aria-hidden="true"></i> Add</button>
<div class="row">
    <div class="col-md-12">
        <div id="divSupplierList"></div>
    </div>
</div>
<div id="divSupplierWin"></div>

<script id="temp_win_delete_entry" type="text/x-kendo-template">
    <div style="padding:1em;">
        <p style="font-size: 14px; padding: 10px"> #=msg# </p>
        <div style="text-align: right;">
            <button type="button" class="k-button k-button-icontext k-primary k-grid-update" id="btn_delete_Entry_noty_ok"><span class="k-icon k-update"></span>OK</button>
            <button type="button" class="k-button k-button-icontext k-grid-cancel" id="btn_delete_Entry_noty_cancel"><span class="k-icon k-cancel"></span>Cancel</button>
        </div>
    </div>
</script>

<script>
     $(document).ready(function () {
         $("#divSupplierList").empty();
         $("#divSupplierList").append('<div class="loading_partial"></div>');
         $("#divSupplierList").load('@Url.Action("SupplierList","Configuration")');
    });

    $("#btnSupplierCreateWin").click(function () {
        $("#divSupplierWin").empty();
        $("#divSupplierWin").kendoWindow({
            actions: ["Close"],
            draggable: false,
            modal: true,
            visible: false,
            width: 638,
            height: 395,
            title: 'Supplier',
            resizable:false
        });
        var supplierWin = $("#divSupplierWin").data("kendoWindow");
        supplierWin.refresh('@Url.Action("CreateSupplier", "Configuration")');
        supplierWin.center().open();
    });

    $("#divSupplierList").on('click', ".btnSupplierEdit", function () {
        var supplierId = $(this).data("id");
        $("#divSupplierWin").empty();
        $("#divSupplierWin").kendoWindow({
            actions: ["Close"],
            draggable: false,
            modal: true,
            visible: false,
            width: 638,
            height: 395,
            title: 'Supplier',
            resizable: false
        });
        var supplierWin = $("#divSupplierWin").data("kendoWindow");
        supplierWin.refresh('@Url.Action("CreateSupplier", "Configuration")?id=' + supplierId);
        supplierWin.center().open();
    });

    $("#divSupplierList").on('click', ".btnSupplierDelete", function () {
        var id = $(this).data("id");
        var kendoWindow = $("<div />").kendoWindow({
            actions: ["Close"],
            title: "Alert",
            resizable: false,
            width: "30%",
            modal: true
        });

        msg = "Are you sure want to delete this Supplier?";
        var template = kendo.template($("#temp_win_delete_entry").html());
        kendoWindow.data("kendoWindow").content(template).center().open();

        kendoWindow.find("#btn_delete_Entry_noty_cancel").click(function () {
            kendoWindow.data("kendoWindow").close();
            document.documentElement.style.overflow = "auto";
        }).end();
        kendoWindow.find("#btn_delete_Entry_noty_ok").click(function () {
            kendoWindow.data("kendoWindow").close();
            document.documentElement.style.overflow = "auto";
            deleteSupplier(id);
        }).end();
        document.documentElement.style.overflow = "hidden";
    });

    function deleteSupplier(id) {
        $.ajax({
            url: '@Url.Action("DeleteSupplier", "Configuration")',
            type: 'Post',
            data: { id: id },
            success: function (data) {
                if (data === "success") {
                   $("#divSupplierList").empty();
                   $("#divSupplierList").append('<div class="loading_partial"></div>');
                   $("#divSupplierList").load('@Url.Action("SupplierList", "Configuration")');
                } else {
                    alert("Supplier Delete Error...");
                }
            }
        });
    }
    $("#divSupplierList").on("click", ".activateSupplier,.inactivateSupplier", function () {
        var id = $(this).data("id");
        var status = $(this).data("isactive");
        var sendData = {
            id: id,
            status: status
        };
        $.ajax({
            url: '@Url.Action("ChangeSupplierStatus", "Configuration")',
            method: 'POST',
            data: sendData,
            success: function (res) {
                if (res == "success") {
                    $("#divSupplierList").empty();
                    $("#divSupplierList").append('<div class="loading_partial"></div>');
                    $("#divSupplierList").load('@Url.Action("SupplierList", "Configuration")');
                }
                else {
                    alert("Error Status Update");
                }
            }
        });
    });
</script>

