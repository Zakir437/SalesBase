@model PointOfSale.Models.ViewStockImport
@using PointOfSale.Helpers;
@using System.Globalization;
@{
    ViewBag.Title = "ImportTransaction";
    Layout = "~/Views/Shared/_LayoutForTemplate.cshtml";
}
<style>
    hr{
        margin:0px;
    }
</style>
@*<section class="content-header">
    <h1>
        Import Transaction
    </h1>
    <ol class="breadcrumb">
        <li><a href="/Inventory/Dashboard"><i class="fa fa-dashboard"></i> Inventory</a></li>
        <li><a href="/Stock/ImportHistory"><i class="fa fa-list-ul"></i> Import History</a></li>
        <li class="active">Import Transaction</li>
    </ol>
</section>*@
<section class="content">
    <div class="panel panel-info">
        <div class="panel-heading" style="padding-bottom:46px;">
            <div class="pull-left">
                <h4 class="uppercase">Import Transaction</h4>
            </div>
            <div class="pull-right">
                <a class="btn btn-default" href="/Stock/ImportHistory"><i class="fa fa-arrow-left"></i> Back</a>
            </div>
        </div>
        <div class="panel-body">
            <h2>
                @Model.RefferenceNo
                <a href="@Html.EncodedParam("ImportTransactionPrint","Stock", new { stockImportId = Model.StockImportId },null)" target="_blank" style="float:right;margin-right:5%;font-size:14px">
                    <i class="fa fa-print"></i> Print
                </a>
            </h2>
            <div class="row">
                <div class="col-xs-6">
                    <dl class="dl-horizontal">
                        <dt>Import By</dt>
                        <dd>@Model.ImportBy</dd>
                        <dt>Supplier</dt>
                        <dd>@Model.SupplierName</dd>
                        <dt>MRR</dt>
                        <dd>@Model.MRR</dd>
                        <dt>Date</dt>
                        <dd>@Convert.ToDateTime(@Model.Date).ToString("MMM dd yyyy hh:mm:ss tt")</dd>
                    </dl>
                </div>
                <div class="col-xs-6">
                    <dl class="dl-horizontal">
                        <dt>Total Cost</dt>
                        <dd>@Model.TotalCost.ToString("C", new CultureInfo("bn-BD"))</dd>
                        <dt>Due Amount</dt>
                        <dd>@Model.DueAmount.ToString("C", new CultureInfo("bn-BD"))</dd>
                    </dl>
                </div>
            </div>
        </div>
        <hr />
        <div class="panel-body">
            <div id="divImportTransactionList"></div>
        </div>
    </div>
</section>
<div id="divTransactionWin"></div>
<div id="divReturnAlertWin"></div>
<div id="divReturnWin"></div>
<script>
    var impTransId = 0;
    $(document).ready(function () {
        $("#liForInventory").addClass('active');
        $("#liForStock").addClass('active');

        $("#divImportTransactionList").empty();
        $("#divImportTransactionList").append('<div class="loading_partial"></div>');
        $("#divImportTransactionList").load('@Url.Action("ImportTransactionList", "Stock")?importId=' + @Model.StockImportId);
    });

    //****************Edit import Transaction************************
    $("#divImportTransactionList").on('click', ".btnImportTransactionEdit", function () {
        impTransId = $(this).data("id");
        $("#divTransactionWin").empty();
        $("#divTransactionWin").kendoWindow({
            actions: ["Close"],
            draggable: false,
            modal: true,
            visible: false,
            width: 638,
            height: 225,
            title: 'Import Transaction',
            resizable: false
        });
        var importTransactionWin = $("#divTransactionWin").data("kendoWindow");
        importTransactionWin.refresh('@Url.Action("ImportTransactionUpdate", "Stock")?importTransactionId=' + impTransId);
        importTransactionWin.center().open();
    });

    //************************Return******************************
    $("#divImportTransactionList").on('click', '.btnReturn', function () {
        impTransId = $(this).data("id");
        $("#divReturnAlertWin").empty();
        $("#divReturnAlertWin").kendoWindow({
                actions: ["Close"],
                draggable: false,
                modal: true,
                visible: false,
                width: 647,
                height: 218,
                resizable: false,
                title: 'Alert'
        });
        var alertWin = $("#divReturnAlertWin").data("kendoWindow");
        alertWin.refresh('@Url.Action("SinglReturnAlert", "Stock")?impTransId=' + impTransId);
        alertWin.center().open();
    });


    $("#divReturnAlertWin").on('click', "#btnRefundConfirm", function () {
        if (validation.validate())
        {
            var returnQuantity = $("#ReturnQuantity").val();
            $("#divReturnAlertWin").data("kendoWindow").close();

            $("#divReturnWin").empty();
            $("#divReturnWin").kendoWindow({
                actions: ["Close"],
                draggable: false,
                modal: true,
                visible: false,
                width: 767,
                height: 280,
                title: 'Pay',
                resizable: false
            });
            var returnWin = $("#divReturnWin").data("kendoWindow");
            returnWin.refresh('@Url.Action("ReturnPay", "Stock")?impTransId=' + impTransId + '&returnQuantity=' + returnQuantity);
            returnWin.center().open().maximize();
        }
    });



</script>